<!DOCTYPE html>
<html
        lang="en"
        class="light-style layout-navbar-fixed layout-menu-fixed"
        layout:decorate="~{layout.html}" xmlns:layout="http://www.w3.org/1999/xhtml"
        xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="">
    <link rel="icon" type="image/x-icon"
          th:href="@{/img/favicon/1644809631_5-abrakadabra-fun-p-domik-na-belom-fone-12.png}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery.maskedinput@1.4.1/src/jquery.maskedinput.min.js"
            type="text/javascript"></script>
    <link rel="stylesheet" th:href="@{/vendor/fonts/fontawesome.css}">
    <link rel="stylesheet" th:href="@{/vendor/fonts/tabler-icons.css}">
    <link rel="stylesheet" th:href="@{/vendor/fonts/flag-icons.css}">
    <link rel="stylesheet" th:href="@{/css/demo.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/node-waves/node-waves.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/typeahead-js/typeahead.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/select2/select2.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/formvalidation/dist/css/formValidation.min.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/animate-css/animate.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/sweetalert2/sweetalert2.css}">
    <!--    <script th:src="@{/js/config.js}"></script>-->
    <!--    <script th:src="@{/vendor/js/template-customizer.js}"></script>-->
    <script th:src="@{/vendor/js/helpers.js}"></script>
    <link rel="stylesheet" th:href="@{/vendor/libs/typeahead-js/typeahead.css}">
    <link rel="stylesheet" th:href="@{/vendor/libs/dropzone/dropzone.css}">
    <script th:src="@{/vendor/libs/select2/select2.js}"></script>
    <style>
        .notification {
            position: fixed;
            top: 90px;
            right: 40px; /* Расстояние справа */
            padding: 10px;
            border: 1px solid #ccc;
            text-align: center;
            transition: opacity 0.5s ease-in-out;
        }

        .notification.hidden {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
</body>

<main layout:fragment="content">

    <div class="content-wrapper">
        <div class="container-fluid">
            <br>
            <div class="d-flex justify-content-between">
                <h4 class="fw-bold" data-translate="new_object">Новый объект</h4>
                <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb" class="d-flex align-items-center">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a th:href="@{/}" data-translate="main">Главная</a></li>
                        <li class="breadcrumb-item"><a th:href="@{/investor_objects}" data-translate="investor_objects">Объекты
                            от инвесторов</a></li>
                        <li class="breadcrumb-item active" aria-current="page" data-translate="create_investor_object"
                            th:href="@{/investor_objects/create}">
                            Создание объекта от инвестора
                        </li>
                    </ol>
                </nav>
            </div>
            <hr style="margin-top: -5px">
            <br>

            <ul class="nav nav-pills mb-3" role="tablist">
                <li class="nav-item">
                    <button class="nav-link active" type="button" aria-selected="true" data-toggle="tab" role="tab"
                            data-bs-toggle="pill" onclick="changeInput('ru')">Ру
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" type="button" aria-selected="false" data-toggle="tab" role="tab"
                            data-bs-toggle="pill" onclick="changeInput('eu')">Eng
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" type="button" aria-selected="false" data-toggle="tab" role="tab"
                            data-bs-toggle="pill" onclick="changeInput('ukr')">Укр
                    </button>
                </li>
            </ul>
            <br>
            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-home"
                            type="button" role="tab" aria-controls="pills-home" aria-selected="true"
                            data-translate="address_section">Адрессная часть
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-profile"
                            type="button" role="tab" aria-controls="pills-profile" aria-selected="false"
                            data-translate="main_section">Основное
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-contact-tab" data-bs-toggle="pill"
                            data-bs-target="#pills-contact"
                            type="button" role="tab" aria-controls="pills-contact" aria-selected="false"
                            data-translate="gallery">Галерея
                    </button>
                </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                    <div class="row">

                        <div class="col-3">
                            <h6 data-translate="region_district">Обл.район</h6>
                            <select class="select2 form-select form-select" data-allow-clear="true" name="region"
                                    id="region">
                                <option selected></option>
                                <option th:each="entity : ${selectRegion}"
                                        th:value="${entity}"
                                        th:text="${entity}"></option>
                            </select>

                        </div>
                        <div class="col-3">
                            <h6 data-translate="city">Нас.пункт</h6>
                            <select class="select2 form-select form-select" name="city" disabled>
                            </select>
                        </div>
                        <div class="col-2">
                            <h6 data-translate="district">Район</h6>
                            <select class="select2 form-select form-select" name="district" disabled>
                                <option selected value=""></option>
                                <option value="1">One</option>
                                <option value="2">Two</option>
                                <option value="3">Three</option>
                            </select></div>
                        <div class="col-2">
                            <div style="display:block;" class="ruContent nameContent">
                                <h6>Улица</h6>
                                <input class="form-control" type="text" name="street" id="street"
                                       placeholder="Введите улицу">
                            </div>
                            <div style="display:none;" class="euContent nameContent">
                                <h6>Улица</h6>
                                <input class="form-control" type="text" name="streetEu" id="streetEu"
                                       placeholder="Введите улицу">
                            </div>
                            <div style="display:none;" class="ukrContent nameContent">
                                <h6>Вулиця</h6>
                                <input class="form-control" type="text" name="streetUkr" id="streetUkr"
                                       placeholder="Введите улицу">
                            </div>
                        </div>
                        <div class="col-2">
                            <h6 data-translate="topozone">Топозона</h6>
                            <select class="select2 form-select form-select" name="topozone">
                                <option value="" selected></option>
                                <option th:each="entity : ${selectTopozone}"
                                        th:value="${entity}"
                                        th:text="${entity}"></option>
                            </select>

                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-2">
                            <h6 data-translate="house_number">Номер дома</h6>
                            <input class="form-control" type="number" name="houseNumber"
                                   placeholder="Введите номер дома">
                        </div>
                        <div class="col-2">
                            <h6 data-translate="section_building">Секция/Корпус</h6>
                            <input class="form-control" type="number" name="section"
                                   placeholder="Введите секцию/корпус">
                        </div>
                        <div class="col-2">
                            <h6 data-translate="apartment_number">Номер квартиры</h6>
                            <input type="text" class="form-control" name="apartmentNumber" id="apartmentNumber"
                                   placeholder="Введите номер квартиры">
                        </div>
                        <div class="col-3" style="display: flex;align-items: end">
                            <button class="btn btn-info" onclick="checkNumber()">Проверить номер телефона</button>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-3">
                            <div style="display:block;" class="ruContent nameContent">
                                <h6 data-translate="owner_name">ФИО владельца </h6>
                                <input class="form-control" type="text" name="owner"
                                       placeholder="Введите ФИО владельца">
                            </div>
                            <div style="display:none;" class="euContent nameContent">
                                <h6 data-translate="owner_name">ФИО владельца </h6>
                                <input class="form-control" type="text" name="ownerEu"
                                       placeholder="Введите ФИО владельца">
                            </div>
                            <div style="display:none;" class="ukrContent nameContent">
                                <h6 data-translate="owner_name">ФИО владельца </h6>
                                <input class="form-control" type="text" name="ownerUkr"
                                       placeholder="Введите ФИО владельца">
                            </div>

                        </div>
                        <div class="col-3">
                            <h6 data-translate="phone" a>Телефон</h6>
                            <input type="tel" name="telephone" id="telephone" class="form-control"
                                   placeholder="Введите номер телефона">
                        </div>
                        <div class="col-3">
                            <h6 data-translate="acquisition_date">Дата приобретения</h6>
                            <input type="date" class="form-control" placeholder="yyyy/MM/dd"
                                   aria-describedby="defaultFormControlHelp" id="boughtDate" name="boughtDate"
                                   value="">
                        </div>
                        <div class="col-3">
                            <h6 data-translate="ownership_rights">Право собственности</h6>
                            <select class="select2 form-select form-select" name="ownership">
                                <option selected></option>
                                <option th:each="status : ${ownershipType}"
                                        th:value="${status}"
                                        th:text="${status}"></option>
                            </select>
                        </div>
                    </div>
                    <br>
                    <h6>Важные заметки</h6>
                    <input class="form-control" type="text" id="notes" placeholder="Введите заметки">
                    <br>
                    <h6>Прикрепить файлы</h6>
                    <input type="file" class="form-control" name="fileInput" id="fileInput" onchange="showFile()">
                    <br>
                    <div id="fileList">

                    </div>
                    <br>
                    <h3>Комментарий администратора</h3>
                    <textarea class="form-control" style="width: 100%; height: 300px"
                              name="comment" placeholder="Введите комментарий"></textarea>
                    <br>
                </div>
                <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-contact-tab">
                    <div class="row">
                        <div class="col-2">
                            <h6>Статус публикации</h6>
                            <select class="select2 form-select form-select" id="publicationStatus">
                                <option selected></option>
                                <option th:each="status : ${publicationStatus}"
                                        th:value="${status}"
                                        th:text="${status}"></option>
                            </select>


                        </div>
                        <div class="col-2">
                            <h6>Код объекта</h6>
                            <input class="form-control" type="text" id="codeObject" placeholder="100-101-102"
                                   name="codeObject">
                        </div>
                        <div class="col-5">
                            <div class="row">
                                <div class="col-3" style="text-align: right">
                                    <h6>Код филиала</h6>
                                </div>
                                <div class="col-1">
                                    <h6>—</h6>
                                </div>
                                <div class="col-4">
                                    <h6> код сотрудника</h6>
                                </div>
                            </div>
                            <div class="row" style="display:flex; align-items: center">
                                <div class="col-3" style="text-align: right">
                                    <input class="form-control" type="number" id="codeBranch" placeholder="Код филиала"
                                           name="codeBranch">
                                </div>
                                <div class="col-1">
                                    <span><h6>—</h6></span>
                                </div>
                                <div class="col-3">
                                    <input class="form-control" type="number" id="codeStaff" name="codeStaff"
                                           placeholder="Код сотрудника">
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-2">
                            <h6>ЖК</h6>
                            <select id="branchSelect3" class="select2 form-select form-select"
                                    name="residentialComplex">
                            </select>
                        </div>
                        <div class="col-2">
                            <h6>Ориентир</h6>
                            <input class="form-control" type="text" id="reference_point" placeholder="Введите ориентир">
                        </div>
                        <div class="col-2">
                            <h6>Этажность</h6>
                            <input class="form-control" type="number" name="floorQuantity"
                                   placeholder="Введите этажность">
                        </div>
                        <div class="col-2">
                            <h6>Этаж</h6>
                            <input class="form-control" type="number" name="floor" placeholder="Введите этаж">
                        </div>
                        <div class="col-2">
                            <h6>Комнат</h6>
                            <input class="form-control" type="number" id="rooms" placeholder="Введите кол-во комнат">
                        </div>
                        <div class="col-2">
                        </div>
                    </div>
                    <br>
                    <h6>Цена</h6>
                    <input class="form-control" type="number" id="price" placeholder="Введите цену">
                    <br>
                    <div class="row">
                        <div class="col-2">
                            <h6>Срок сдачи</h6>
                            <select id="buildStatus" class="select2 form-select form-select">
                                <option selected></option>
                                <option th:each="status : ${propertyBuildStatus}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select>
                        </div>
                        <div class="col-2">
                            <h6>Год срока сдачи дома</h6>
                            <input type="number" class="form-control" placeholder="Введите год срока сдачи дома" id="yearBuilding" >
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-2">
                            <h6>S общая (м.кв.)*</h6>
                            <input class="form-control" type="number" id="areaTotal"
                                   placeholder="Введите общую площадь">
                        </div>
                        <div class="col-2">
                            <h6>S жилая (м.кв.)*</h6>
                            <input class="form-control" type="number" id="areaLiving"
                                   placeholder="Введите жилую площадь">
                        </div>
                        <div class="col-2">
                            <h6>S кухни (м.кв.)*</h6>
                            <input class="form-control" type="number" id="areaKitchen"
                                   placeholder="Введите площадь кухни">
                        </div>
                        <div class="col-2">
                            <h6>Метраж комнат</h6>
                            <input class="form-control" type="text" id="footageOfRooms"
                                   placeholder="10+10+10">

                        </div>
                        <div class="col-2">
                            <h6>Высота потолка (м)</h6>
                            <input class="form-control" type="number" step="0.01" id="myNumberInput"
                                   placeholder="Введите высоту потолка">
                        </div>
                        <div class="col-2">
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-3">
                            <h6>Материал стен</h6>

                            <div style="display:block;" class="ruContent nameContent">
                                <input class="form-control" type="text" id="wall_material"
                                       placeholder="Введите материал стен">
                            </div>
                            <div style="display:none;" class="euContent nameContent">
                                <input class="form-control" type="text" id="wall_materialEn"
                                       placeholder="Введите материал стен">
                            </div>
                            <div style="display:none;" class="ukrContent nameContent">
                                <input class="form-control" type="text" id="wall_materialUkr"
                                       placeholder="Введите материал стен">
                            </div>
                        </div>
                        <div class="col-3">
                            <h6>Состояние квартиры</h6>
                            <select id="state" class="select2 form-select form-select">
                                <option selected></option>
                                <option th:each="status : ${propertyOrigin}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-3">
                            <h6>Кухня</h6>
                            <select id="kitchen" class="select2 form-select form-select">
                                <option selected></option>
                                <option th:each="status : ${kitchenType}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select></div>
                        <div class="col-3">
                            <h6>Санузел</h6>
                            <select id="bathroom" class="select2 form-select form-select">
                                <option selected></option>
                                <option th:each="status : ${bathroomType}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select>
                        </div>
                        <div class="col-2">
                            <h6>Балкон/лоджия</h6>
                            <select id="balcony" class="select2 form-select form-select" name="balconyType">
                                <option selected></option>
                                <option th:each="status : ${balconyType}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select>
                        </div>
                        <div class="col-2">
                            <h6>Вид из окон</h6>
                            <select id="viewWindow" class="select2 form-select form-select">
                                <option selected></option>
                                <option th:each="status : ${windowViewType}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-3">
                            <h6>Кухонная плита</h6>
                            <select class="select2 form-select form-select" name="kitchenStoveType" id="kitchenStove">
                                <option selected></option>
                                <option th:each="status : ${kitchenStoveType}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select></div>
                        <div class="col-3">
                            <h6>Отопление
                            </h6>
                            <select id="heating" class="select2 form-select form-select">
                                <option selected></option>
                                <option th:each="status : ${heatingType}"
                                        th:value="${status}"
                                        th:text="${status.status}"></option>
                            </select>
                        </div>
                        <br>

                    </div>
                    <br>
                    <div class="row">
                        <div class="col-2">
                            <h6>Дата последнего контакта</h6>
                            <input type="date" class="form-control" placeholder="yyyy/MM/dd"
                                   aria-describedby="defaultFormControlHelp" id="dateLastContact" name="dateLastContact"
                                   value="">
                        </div>
                        <div class="col-1" style="display: flex; align-items: end">
                            <input class="form-check-input" type="checkbox" value="true" name="statusVNP">
                            <span class="checkmark"> ВНП</span>
                        </div>
                        <div class="col-2">
                            <h6>Дата внп до</h6>
                            <input type="date" class="form-control" placeholder="yyyy/MM/dd"
                                   aria-describedby="defaultFormControlHelp" id="dateVNP" name="dateVnp"
                                   value="">
                        </div>
                        <div class="col-2">
                            <h6>Источник информации</h6>
                            <input type="text" class="form-control" id="sourceInformation"
                                   placeholder="Введите источник информации">
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-2">
                            <input class="form-check-input" type="checkbox" value="true" name="tor">
                            <span class="checkmark">Торг</span>
                        </div>
                        <div class="col-2">
                            <input class="form-check-input" type="checkbox" value="true" name="exclusive">
                            <span class="checkmark">Ексклюзив</span>
                        </div>
                        <div class="col-2">
                            <input class="form-check-input" type="checkbox" value="true" name="urgently">
                            <span class="checkmark">Срочно</span>
                        </div>
                        <div class="col-2">
                            <input class="form-check-input" type="checkbox" value="true" name="free">
                            <span class="checkmark">Свободная</span>
                        </div>
                        <div class="col-2">
                            <input class="form-check-input" type="checkbox" value="true" name="objectOpen">
                            <span class="checkmark">Объект открыт</span>
                        </div>
                        <div class="col-2">
                            <input class="form-check-input" type="checkbox" value="true" name="fromIntermediary">
                            <span class="checkmark">От посредника</span>
                        </div>
                    </div>
                    <br>
                    <br>
                    <h6>Описание</h6>
                    <div style="display:block;" class="ruContent nameContent">
                        <textarea class="form-control" style="width: 100%; height: 300px"
                                  name="descriptionObject" placeholder="Введите описание"></textarea>
                    </div>
                    <div style="display:none;" class="euContent nameContent">
                        <textarea class="form-control" style="width: 100%; height: 300px"
                                  name="descriptionObjectEu" placeholder="Введите описание"></textarea>
                    </div>
                    <div style="display:none;" class="ukrContent nameContent">
                         <textarea class="form-control" style="width: 100%; height: 300px"
                                   name="descriptionObjectUkr" placeholder="Введите описание"></textarea>
                    </div>
                    <br>
                    <h6>Рекламный заголовок</h6>

                    <div style="display:block;" class="ruContent nameContent">
                        <input type="text" name="advertisingName" id="promotionName" class="form-control"
                               placeholder="Укажите рекламный заголовок">
                    </div>
                    <div style="display:none;" class="euContent nameContent">
                        <input type="text" name="advertisingNameEu" id="promotionNameEu" class="form-control"
                               placeholder="Укажите рекламный заголовок">
                    </div>
                    <div style="display:none;" class="ukrContent nameContent">
                        <input type="text" name="advertisingNameUkr" id="promotionNameUkr" class="form-control"
                               placeholder="Укажите рекламный заголовок">
                    </div>
                    <br>
                    <h6>Рекламный текст</h6>

                    <div style="display:block;" class="ruContent nameContent">
                       <textarea style="width: 100%; height: 300px" name="advertisingText"
                                 class="form-control" placeholder="Введите рекламный текст"></textarea>
                    </div>
                    <div style="display:none;" class="euContent nameContent">
                        <textarea style="width: 100%; height: 300px" name="advertisingTextEu"
                                  class="form-control" placeholder="Введите рекламный текст"></textarea>
                    </div>
                    <div style="display:none;" class="ukrContent nameContent">
                        <textarea style="width: 100%; height: 300px" name="advertisingTextUkr"
                                  class="form-control" placeholder="Введите рекламный текст"></textarea>
                    </div>
                    <br>
                    <input class="form-check-input" type="checkbox" value="true" name="statusPromotion"><span
                        class="checkmark">Рекламировать</span>
                </div>
                <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-profile-tab">

                    <div class="row">
                        <div class="col-12">
                            <div class="card-body">
                                <form action="/uploadFileInvestor" class="dropzone needsclick dz-clickable"
                                      id="my-dropzoneInvestor">
                                    <div class="dz-message needsclick">
                                        <span class="note needsclick"></span>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div style="text-align: right; margin: 20px">
                <button class="btn btn-submit">Отмена</button>
                <span>
                <button class="btn btn-success" hx-trigger="click" onclick="sendForm()">
                Сохранить </button>
            </span>
            </div>
        </div>
    </div>
    <div class="alert alert-warning notification  d-flex align-items-center hidden" role="alert"
         id="notification">
        <svg width="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5.94118 10.7474V20.7444C5.94118 21.0758 5.81103 21.3936 5.57937 21.628C5.3477 21.8623 5.0335 21.994 4.70588 21.994H2.23529C1.90767 21.994 1.59347 21.8623 1.36181 21.628C1.13015 21.3936 1 21.0758 1 20.7444V11.997C1 11.6656 1.13015 11.3477 1.36181 11.1134C1.59347 10.879 1.90767 10.7474 2.23529 10.7474H5.94118ZM5.94118 10.7474C7.25166 10.7474 8.50847 10.2207 9.43512 9.28334C10.3618 8.34594 10.8824 7.07456 10.8824 5.74887V4.49925C10.8824 3.83641 11.1426 3.20071 11.606 2.73201C12.0693 2.26331 12.6977 2 13.3529 2C14.0082 2 14.6366 2.26331 15.0999 2.73201C15.5632 3.20071 15.8235 3.83641 15.8235 4.49925V10.7474H19.5294C20.1847 10.7474 20.8131 11.0107 21.2764 11.4794C21.7397 11.9481 22 12.5838 22 13.2466L20.7647 19.4947C20.5871 20.2613 20.25 20.9196 19.8045 21.3704C19.3589 21.8211 18.8288 22.04 18.2941 21.994H9.64706C8.6642 21.994 7.72159 21.599 7.0266 20.896C6.33162 20.1929 5.94118 19.2394 5.94118 18.2451"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round"/>
        </svg>
        <strong id="text_notification"></strong>
        <div>
            <span id="notification-message"></span>
        </div>
    </div>
    <script th:src="@{/vendor/libs/dropzone/dropzone.js}"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-rc.0/js/select2.min.js"></script>

    <script th:inline="javascript">
        function checkNumber() {
            let checkNumber = $("#telephone").val()
            var regExp = /^\+380(31|32|33|34|35|36|38|39|41|43|44|45|46|20|89|94|92|91|67|68|96|97|98|70|90|91|67|68|96|97|98|70|87|89|50|66|95|99)\d{7}$/;
            console.log(checkNumber)
            if (regExp.test(checkNumber)) {
                showNotification("Номер корректный", "", true)
            } else {
                showNotification("Такого номера не существует", "", false)
            }
        }

        let langOld = "ru";

        function changeInput(lang) {
            $(".nameContent").css("display", "none")
            $("." + lang + "Content").css("display", "block");
            langOld = lang.toString();
            console.log(langOld)
        }


        function sendForm() {
            let formData = new FormData();
            var address = {
                region: $("#region").val(),

                street: $("#street").val(),
                streetEng: $("#streetEu").val(),
                streetUkr: $("#streetUkr").val(),

                district: $('[name="district"]').val(),
                city: $('[name="city"]').val(),
                zone: $('[name="topozone"]').val(),
                section: $('[name="section"]').val(),
                houseNumber: $('[name="houseNumber"]').val()
            };
            for (var key in address) {
                if (address.hasOwnProperty(key)) {
                    formData.append("address." + key, address[key]);
                }
            }


            formData.append("apartmentNumber", $('[name="apartmentNumber"]').val());
            formData.append("buildFinishDate", $("#yearBuilding").val());


            formData.append("ownerName", $('[name="owner"]').val());
            formData.append("ownerNameEng", $('[name="ownerEu"]').val());
            formData.append("ownerNameUkr", $('[name="ownerUkr"]').val());

            formData.append("ownerPhone", $('[name="telephone"]').val());
            console.log($('[name="boughtDate"]').val())
            formData.append("boughtDate", $('[name="boughtDate"]').val());
            console.log($('[name="boughtDate"]').val());
            let indexFilesMap = 0;
            if (fileMap.size > 0) {
                for (const [key, file] of fileMap) {
                    formData.append(key, file);
                    formData.append(`files[${indexFilesMap}]`, file);
                    indexFilesMap++;
                }
            }
            formData.append("administrationComment", $('[name="comment"]').val());
            formData.append("publicationStatus", $("#publicationStatus").val());
            formData.append("objectCode", $('[name="codeObject"]').val());
            formData.append("branchCode", $('[name="codeBranch"]').val());
            formData.append("employeeCode", $('[name="codeStaff"]').val());
            formData.append("ownershipType", $('[name="ownership"]').val());
            formData.append("landmark", $("#reference_point").val());
            formData.append("residentialComplexId", $('[name="residentialComplex"]').val());
            formData.append("floorQuantity", $('[name="floorQuantity"]').val());
            formData.append("floor", $('[name="floor"]').val());
            formData.append("employeeCode", $('[name="codeStaff"]').val());
            formData.append("roomQuantity", $("#rooms").val());
            formData.append("price", $("#price").val());
            formData.append("notes", $("#notes").val());

            formData.append("areaTotal", $("#areaTotal").val());
            formData.append("areaLiving", $("#areaLiving").val());
            formData.append("areaKitchen", $("#areaKitchen").val());
            formData.append("roomMeters", $("#footageOfRooms").val());

            formData.append("heightCeiling", $("#myNumberInput").val());
            formData.append("wallMaterial", $("#wall_material").val());
            formData.append("wallMaterialEng", $("#wall_materialEn").val());
            formData.append("wallMaterialUkr", $("#wall_materialUkr").val());


            formData.append("propertyOrigin", $("#state").val());
            formData.append("kitchenType", $("#kitchen").val());
            formData.append("buildStatus", $("#buildStatus").val());

            formData.append("bathroomType", $("#bathroom").val());
            formData.append("balconyType", $("#balcony").val());
            formData.append("windowViewType", $("#viewWindow").val());
            formData.append("kitchenStoveType", $("#kitchenStove").val());
            formData.append("heatingType", $("#heating").val());


            formData.append("lastContactDate", $("#dateLastContact").val());
            formData.append("vnp", $('[name="statusVNP"]').prop("checked"));
            formData.append("vnpExpirationDate", $("#dateVNP").val());

            formData.append("informationSource", $("#sourceInformation").val());
            formData.append("bargain", $('[name="tor"]').prop("checked"));
            formData.append("exclusive", $('[name="exclusive"]').prop("checked"));
            formData.append("urgent", $('[name="urgently"]').prop("checked"));
            formData.append("free", $('[name="free"]').prop("checked"));
            formData.append("open", $('[name="objectOpen"]').prop("checked"));
            formData.append("intermediary", $('[name="fromIntermediary"]').prop("checked"));

            formData.append("description", $('[name="descriptionObject"]').val());
            formData.append("descriptionEn", $('[name="descriptionObjectEu"]').val());
            formData.append("descriptionUk", $('[name="descriptionObjectUkr"]').val());


            formData.append("advertisementHeadline", $('[name="advertisingName"]').val());
            formData.append("advertisementHeadlineEn", $('[name="advertisingNameEu"]').val());
            formData.append("advertisementHeadlineUk", $('[name="advertisingNameUkr"]').val());

            formData.append("advertisementText", $('[name="advertisingText"]').val());
            formData.append("advertisementTextEn", $('[name="advertisingTextEu"]').val());
            formData.append("advertisementTextUk", $('[name="advertisingTextUkr"]').val());

            formData.append("advertisementEnabled", $('[name="statusPromotion"]').prop("checked"));


            let i = 1;
            for (let [fileName, file] of uploadedFiles) {
                if (i > 15) {
                    break;
                }
                formData.append("pictures[]", file);
                i++;
            }
            console.log(formData.get("pictures[]"))

            let contextPath =/*[[@{/}]]*/'';
            let url = contextPath.toString() + "investor_objects/create";
            $.ajax({
                url: url,
                method: "POST",
                contentType: false,
                processData: false,
                data: formData,
                success: function () {
                    showNotification("Объект сохранен!", "", true);
                },
                error: function (xhr, status, error) {
                    if (xhr.status === 400) {
                        var errors = JSON.parse(xhr.responseText);
                        errors.forEach(function (error) {
                            console.log("Ошибка: " + error);
                            showNotification("Ошибка!", error, false);
                        });
                    } else {
                        console.log("Другая ошибка: " + xhr.status + " - " + error);
                        showNotification("Другая ошибка!", "Произошла ошибка на сервере", false);
                    }
                }
            })

        }

        var fileInput = document.getElementById("fileInput");
        var fileList = document.getElementById("fileList");
        let fileMap = new Map();
        let numFile = 0;

        function showFile() {
            if (fileInput.files.length > 0) {
                for (var i = 0; i < fileInput.files.length; i++) {
                    var selectedFile = fileInput.files[i];
                    if (
                        selectedFile.type === "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" ||
                        selectedFile.type === "application/pdf"
                    ) {
                        var fileLink = document.createElement("a");
                        fileLink.href = URL.createObjectURL(selectedFile);
                        fileLink.download = selectedFile.name;
                        fileLink.textContent = "Скачать " + selectedFile.name;
                        fileLink.id = "file" + numFile
                        fileList.appendChild(fileLink);
                        var deleteButton = document.createElement("button");
                        deleteButton.style.marginLeft = "20px";
                        deleteButton.classList.add("btn", "btn-danger", "btn-sm", "float-right", "for-delete");
                        deleteButton.innerHTML = `<i class="fa fa-trash"></i>`;
                        deleteButton.id = "deleteFile" + numFile;
                        fileList.appendChild(deleteButton);
                        var lineBreak = document.createElement("br");
                        lineBreak.id = "lineBreak" + numFile;
                        var lineBreak2 = document.createElement("br");
                        lineBreak2.id = "lineBreak2" + numFile;
                        let numListener = numFile;
                        deleteButton.addEventListener("click", function () {
                            deleteFile(fileLink.id, deleteButton.id, lineBreak.id, lineBreak2.id, numListener);
                        });
                        fileList.appendChild(lineBreak);
                        fileList.appendChild(lineBreak2);
                        fileMap.set(numListener, selectedFile);
                        numFile++;
                    } else {
                        showNotification("Выберите файл формата .xlsx или .pdf.", "", false);
                    }
                }
            }
            fileInput.value = "";
        }

        $(document).ready(function () {
            branchSelect3()
        })

        function deleteFile(e, e2, e3, e4, num) {
            $("#" + e).remove();
            $("#" + e2).remove();
            $("#" + e3).remove();
            $("#" + e4).remove();
            fileMap.delete(num);
        }

        var inputElement = document.getElementById("codeObject");
        inputElement.addEventListener("input", function () {
            var inputValue = inputElement.value;
            var numericValue = inputValue.replace(/[^0-9-]/g, '');
            inputElement.value = numericValue;
        });
        var inputElement2 = document.getElementById("footageOfRooms");
        inputElement2.addEventListener("input", function () {
            var inputValue = inputElement2.value;
            var numericValue = inputValue.replace(/[^0-9+]/g, '');
            inputElement2.value = numericValue;
        });

        function branchSelect3() {
            let contextPath = /*[[@{/}]]*/ '';
            $('#branchSelect3').select2({
                ajax: {
                    url: contextPath + 'builder_objects/for/select',
                    dataType: 'json',
                    delay: 1500,
                    data: function (params) {
                        var number = params.page > 0 ? params.page - 1 : 0;
                        return {
                            query: params.term || '',
                            page: number,
                            size: 10
                        };
                    },
                    processResults: function (data, params) {
                        var results = data.content.map(function (item) {
                            return {id: item.id, text: item.name};
                        });
                        var hasMore = data.totalPages > data.number;
                        return {
                            results: results,
                            pagination: {
                                more: hasMore
                            }
                        };
                    },
                    cache: true
                }
            });
        }


        const previewTemplate = `<div class="dz-preview dz-file-preview">
<div class="dz-details">
  <div class="dz-thumbnail">
    <img data-dz-thumbnail>
    <span class="dz-nopreview">No preview</span>
    <div class="dz-success-mark"></div>
    <div class="dz-error-mark"></div>
    <div class="dz-error-message"><span data-dz-errormessage></span></div>
    <div class="progress">
      <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuemin="0" aria-valuemax="1000" data-dz-uploadprogress></div>
    </div>
  </div>
  <div class="dz-filename" data-dz-name></div>
  <div class="dz-size" data-dz-size></div>
</div>
</div>`;
        let uploadedFiles = new Map();
        let oldImagesArray = [];
        let currentFiles = 0;

        var myDropzone = new Dropzone("#my-dropzoneInvestor", {
            url: "/uploadFileInvestor",
            acceptedFiles: ".jpg, .png, .icon, .jpeg",
            previewTemplate: previewTemplate,
            parallelUploads: 5,
            maxFilesize: 10,
            addRemoveLinks: true,
            maxFiles: 15,
            autoProcessQueue: true,
            success: function (file, response) {
                console.log("Файл загружен: " + file.name);
                console.log("Ответ сервера: " + response);
                console.log(currentFiles);
                console.log(myDropzone.maxFiles);
                currentFiles++;
                const imageElement = file.previewElement.querySelector("img[data-dz-thumbnail]");
                imageElement.src = file.dataURL;
            }
        })
        myDropzone.on('success', function (file, response) {
            console.log('Файл успешно загружен:', file.name);
            if (oldImagesArray.includes(file.name)) {
                uploadedFiles.set("wrr2142" + file.name, file);
            } else {
                uploadedFiles.set(file.name, file);
            }
        });
        myDropzone.on('removedfile', function (file) {
            console.log('Файл был удален:', file.name);
            currentFiles--;
            if (uploadedFiles.has(file.name)) {
                uploadedFiles.delete(file.name);
            } else {
                console.log('Файл не найден в uploadedFiles Map.');
                oldImagesArray = oldImagesArray.filter(function (item) {
                    return item !== file.name;
                });
                console.log(oldImagesArray);
            }
            updateDropzoneMaxFiles()
        });
        myDropzone.on("addedfile", function (file) {
            console.log("Начало загрузки файла: " + file.name);

        });
        myDropzone.on('queuecomplete', function () {
            console.log('Загрузка всех файлов завершена.');
        });

        function updateDropzoneMaxFiles() {
            const newMaxFiles = (15 - oldImagesArray.length);
            myDropzone.options.maxFiles = newMaxFiles;
        }


        // Настройки
        $('#telephone').mask('+380999999999');
        $('[name="city"]').change(function () {
            let selectedValue = $(this).val();
            console.log(selectedValue)
            let contextPath = /*[[@{/}]]*/ '';
            let url = contextPath.toString() + "getDistrict/" + selectedValue.toString();
            console.log(url)
            if (selectedValue.toString() == "") {
                const container2 = $('[name="district"]');
                container2.empty();
                container2.prop('disabled', true);
            } else {
                $.ajax({
                    url: url,
                    method: "GET",
                    data: {
                        selectedValue: selectedValue
                    },
                    dataType: 'json',
                    success: function (data) {
                        console.log(data)
                        if (Array.isArray(data)) {
                            const container = $('[name="district"]');
                            if (container.is(':disabled')) {
                                container.removeAttr('disabled');
                            }
                            container.empty();
                            let selectionItem = '<option value=""></option> ';
                            if (data.length > 0) {
                                data.forEach(function (category) {
                                    selectionItem += '<option value="' + category + '">' + category + '</option>';
                                });
                            }
                            container.append(selectionItem);
                        }
                    },
                    error: function (error) {
                        console.log("Error:", error);
                    }
                });
            }
        });
        $("#region").change(function () {
            let selectedValue = $(this).val();
            console.log(selectedValue)
            let contextPath = /*[[@{/}]]*/ '';
            let url = contextPath.toString() + "getCity/" + selectedValue.toString();
            console.log(url)
            if (selectedValue.toString() == "") {
                const container = $('[name="city"]');
                container.empty();
                container.prop('disabled', true);
                const container2 = $('[name="district"]');
                container2.empty();
                container2.prop('disabled', true);
            } else {
                $.ajax({
                    url: url,
                    method: "GET",
                    data: {
                        selectedValue: selectedValue
                    },
                    dataType: 'json',
                    success: function (data) {
                        console.log(data)
                        if (Array.isArray(data)) {
                            const container = $('[name="city"]');
                            if (container.is(':disabled')) {
                                container.removeAttr('disabled');
                            }
                            container.empty();
                            let selectionItem = '<option value=""></option> ';
                            if (data.length > 0) {
                                data.forEach(function (category) {
                                    selectionItem += '<option value="' + category + '">' + category + '</option>';
                                });
                            }
                            container.append(selectionItem);
                            const container2 = $('[name="district"]');
                            container2.empty();
                            container2.prop('disabled', true);
                        }
                    },
                    error: function (error) {
                        console.log("Error:", error);
                    }
                });
            }
        });


    </script>
</main>


</body>
</html>